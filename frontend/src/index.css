@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  @apply font-serif antialiased;
}

/* 主题色来自 JS 注入的 :root 变量（见 theme/constants getThemeCssVars） */
.ritual-form .ant-form-item-label > label {
  color: rgba(var(--theme-paper-rgb), 0.9);
}
.ritual-form .ant-form-item-explain-error {
  color: var(--theme-error);
}
.ant-picker-dropdown {
  z-index: 1100;
}

/* 语言/主题下拉箭头：展开时旋转 */
.ant-select-arrow {
  transition: transform 0.2s ease;
}
.ant-select-open .ant-select-arrow {
  transform: rotate(180deg);
}

/* 所有下拉/弹层边框与背景随主题，无阴影 */
.ant-dropdown .ant-dropdown-menu {
  border: 1px solid color-mix(in srgb, var(--theme-gold) 35%, transparent);
  background: var(--theme-ink) !important;
  border-radius: 8px;
  box-shadow: none;
}
.ant-dropdown .ant-dropdown-menu-item {
  color: var(--theme-paper);
}
.ant-dropdown .ant-dropdown-menu-item:hover {
  background: color-mix(in srgb, var(--theme-gold) 15%, transparent) !important;
  color: var(--theme-paper);
}

/* Select 组件选中项背景（与 hover 保持一致） */
.ant-select-item-option-selected:not(.ant-select-item-option-disabled) {
  background: color-mix(in srgb, var(--theme-gold) 15%, transparent) !important;
  color: var(--theme-paper) !important;
}

/* active/focused option when dropdown opens or keyboard navigates
   全局 active 使用主题色（上面规则），但用户菜单不应默认高亮 */
.ant-select-item-option-active {
  background: color-mix(in srgb, var(--theme-gold) 15%, transparent) !important;
}

/* 用户菜单打开时不希望有默认高亮 */
.user-menu-select .ant-select-item-option-active {
  background: transparent !important;
}

/* 用户菜单使用 Select 组件，定制其下拉样式
   保留轻微圆角与紧凑内距，其它外观由通用 .ant-select-dropdown 处理 */
.user-menu-select .ant-select-dropdown {
  border-radius: 8px;
  padding: 2px 0;
  min-width: auto;
}
.user-menu-select .ant-select-item {
  padding: 8px 12px;
  margin: 0;
}

/* 移动端抽屉内：语言/主题/用户菜单下拉占满宽度 */
.header-actions-stack .ant-select {
  width: 100% !important;
  max-width: 100%;
}
.header-actions-stack .ant-select-selector {
  width: 100% !important;
}

/* 移动端抽屉：滑入动画 + 与页面一致的深色 */
.mobile-drawer-overlay {
  animation: mobile-overlay-in 0.2s ease-out;
}
.mobile-drawer {
  animation: mobile-drawer-in 0.25s ease-out;
}
@keyframes mobile-overlay-in {
  from { opacity: 0; }
  to { opacity: 1; }
}
@keyframes mobile-drawer-in {
  from { transform: translateX(100%); }
  to { transform: translateX(0); }
}

/* 抽屉内 Select 与深色背景一致，避免白底 */
.header-actions-stack .ant-select .ant-select-selector {
  background: color-mix(in srgb, var(--theme-gold) 8%, var(--theme-ink)) !important;
  border-color: color-mix(in srgb, var(--theme-gold) 30%, transparent) !important;
  color: var(--theme-paper);
}
.header-actions-stack .ant-select:hover .ant-select-selector {
  border-color: color-mix(in srgb, var(--theme-gold) 50%, transparent) !important;
}

/* 所有控件 focus 时不要 outline */
[role="combobox"]:focus,
[role="combobox"]:focus-visible,
.ant-select-selector:focus,
.ant-select-selector:focus-visible,
button:focus,
button:focus-visible {
  outline: none;
}
